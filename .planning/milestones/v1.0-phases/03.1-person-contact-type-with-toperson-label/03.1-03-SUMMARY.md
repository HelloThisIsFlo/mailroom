---
phase: 03.1-person-contact-type-with-toperson-label
plan: 03
subsystem: testing
tags: [human-tests, fastmail, person-contact, company-contact, carddav, vcard]

# Dependency graph
requires:
  - phase: 03.1-person-contact-type-with-toperson-label
    provides: Workflow contact_type routing (person via @ToPerson, company via @ToImbox) and CardDAV upsert with contact_type parameter
  - phase: 03-triage-pipeline
    provides: ScreenerWorkflow poll() end-to-end cycle
provides:
  - Live Fastmail validation that @ToPerson creates person-type contacts (FN + N with first/last, no ORG)
  - Live Fastmail validation that @ToImbox creates company-type contacts (FN + ORG, empty N)
  - Human test scripts for ongoing regression testing of contact type rendering
affects: [04-01-PLAN.md]

# Tech tracking
tech-stack:
  added: []
  patterns: [human integration test for vCard contact type rendering]

key-files:
  created:
    - human-tests/test_11_person_contact.py
    - human-tests/test_12_company_contact.py
  modified: []

key-decisions:
  - "Human tests follow existing standalone pattern (own connections, dotenv, step-level PASS/FAIL)"
  - "Visual verification pauses included for Fastmail UI contact rendering confirmation"

patterns-established:
  - "Contact type human test: create contact via poll(), fetch vCard via CardDAV, verify field structure, pause for visual confirmation"

requirements-completed: ["CDAV-03 (extended)", "TRIAGE-02 (extended)"]

# Metrics
duration: 5min
completed: 2026-02-25
---

# Phase 3.1 Plan 03: Human Integration Tests for Person and Company Contact Types Summary

**Two human test scripts validate person-type (@ToPerson) and company-type (@ToImbox) contact creation against live Fastmail, confirming vCard field structure and UI rendering**

## Performance

- **Duration:** 5 min
- **Started:** 2026-02-25T02:30:00Z
- **Completed:** 2026-02-25T02:35:00Z
- **Tasks:** 2
- **Files modified:** 2

## Accomplishments
- test_11_person_contact.py validates @ToPerson creates person-type contacts: FN set, N with first/last name, no ORG, NOTE contains "Added by Mailroom"
- test_12_company_contact.py validates @ToImbox creates company-type contacts: FN set, empty N (N:;;;;), ORG matches FN, NOTE contains "Added by Mailroom"
- Both scripts confirmed passing against live Fastmail with correct person/company icon rendering in Fastmail Contacts UI
- Scripts follow existing human test patterns: standalone, dotenv credentials, step-level PASS/FAIL, interactive pauses for visual verification

## Task Commits

Each task was committed atomically:

1. **Task 1: Create human test scripts for person and company contact types** - `4f3599f` (test)
2. **Task 2: Verify person and company contacts render correctly in Fastmail** - checkpoint approved (no commit, human verification)

## Files Created/Modified
- `human-tests/test_11_person_contact.py` - Standalone human test: applies @ToPerson label, runs poll(), verifies person-type vCard (FN, N with first/last, no ORG, NOTE), pauses for visual Fastmail verification
- `human-tests/test_12_company_contact.py` - Standalone human test: applies @ToImbox label, runs poll(), verifies company-type vCard (FN, ORG, empty N, NOTE), pauses for visual Fastmail verification

## Decisions Made
- Human tests follow existing standalone pattern with own JMAP+CardDAV connections, dotenv credential loading, and step-level PASS/FAIL reporting
- Visual verification pauses included so user can confirm Fastmail UI renders person icon vs company icon correctly

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered
None

## User Setup Required
None - no external service configuration required. Scripts use existing MAILROOM_ env vars.

## Next Phase Readiness
- Phase 3.1 complete: all 3 plans executed, person and company contact types fully validated end-to-end
- All human tests pass against live Fastmail (test_11 for person, test_12 for company)
- Ready to proceed to Phase 4: Packaging and Deployment

## Self-Check: PASSED

- All key files exist on disk (test_11_person_contact.py, test_12_company_contact.py)
- Task 1 commit verified in git log (4f3599f)
- Task 2 was a human verification checkpoint (approved by user)

---
*Phase: 03.1-person-contact-type-with-toperson-label*
*Completed: 2026-02-25*
